function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o={},s={},r=t.parcelRequire3984;null==r&&((r=function(e){if(e in o)return o[e].exports;if(e in s){var t=s[e];delete s[e];var r={id:e,exports:{}};return o[e]=r,t.call(r.exports,r,r.exports),r.exports}var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(e,t){s[e]=t},t.parcelRequire3984=r),r("kyEFX").register(JSON.parse('{"5ZPII":"index.b4f11b24.js","cKEZp":"amazon_icon.ee2c0db3.svg","gcCvB":"ibooks.41e12916.svg","d1j6q":"index.b4e3a0f5.js"}')),r("bUb57"),r("jeON5"),r("76jN1");var n=r("aiKfP"),a=r("hqv3x");const l=new(0,n.booksAPI),i=document.querySelector(".category-list-box");i.addEventListener("click",g);const c=document.querySelector(".books-box"),d=document.querySelector(".btn-up-scroll");let m,u,p,b=!0;async function g({target:e}){if(p&&(p.abort(),console.log("abort previous books fetch")),e.classList.contains("category-list-item")||e.classList.contains("js-btn-more")){(0,a.changeActiveItem)(u,m,e);const t=e.id.split(" ").join("%20");if("all-categories-item"===t){c.innerHTML="";const e=(0,a.createBooksBoxTitle)(c,"Best Sellers Books");b||(0,a.scrollToBoxTop)(c);const t=(0,a.createLoader)(e);p=new AbortController;const o=await async function(e){try{const{data:t}=await l.getTopBooks(e);return t.length?t:Notify.failure("Can't find best sellers books on the server. Please reload the page!")}catch(e){if("ERR_CANCELED"!==e.code){console.error(e);const t=document.createElement("div");c.append(t),t.classList.add("error-box"),t.innerHTML='<p class="error-box-text">Sorry, there was a server error, please reload the page!!!</p>'}return[]}}(p);if(t.remove(),o.length){const t=document.createElement("ul");t.classList.add("list","best-books-list"),e.after(t),t.addEventListener("click",k);const s=document.documentElement.scrollWidth;t.innerHTML=y(o,s<768?1:s<1440&&s>=768?3:5),b?b=!1:(0,a.scrollToBoxTop)(c)}}else{c.innerHTML="";const o=(0,a.createBooksBoxTitle)(c,e.id);(0,a.scrollToBoxTop)(c);const s=(0,a.createLoader)(o);p=new AbortController;const r=await async function(e,t){try{const{data:o}=await l.getBooksByCategory(e,t);return o.length?o:Notify.failure("Can't find books of category <"+e+"> on the server. Please reload the page!")}catch(e){if("ERR_CANCELED"!==e.code){console.error(e);const t=document.createElement("div");c.append(t),t.classList.add("error-box"),t.innerHTML='<p class="error-box-text">Sorry, there was a server error, please reload the page!!!</p>'}return[]}}(t,p);if(s.remove(),r.length){const e=document.createElement("ul");o.after(e),e.classList.add("list","category-books-list");const t=document.documentElement.scrollWidth;e.innerHTML=h(r,t<768?1:t<1440&&t>=768?3:5),(0,a.scrollToBoxTop)(c)}}}}async function k(e){e.preventDefault();const{target:t}=e;t.classList.contains("js-btn-more")&&g(e)}function y(e,t){return e.map((({list_name:e,books:o})=>{const s=`<p class="theme-book">${e}</p>`;if(o.length){return`<li class="best-book-container">${s}\n                            <ul class="list-books">${o.splice(0,t).map((({_id:e,book_image:t,title:o,author:s})=>`<li class="item-book" data-id="${e}">\n                    <div class="img-owerlay">\n                        <img src="${t}" alt="${o}" class="img-book" loading="auto">\n                        <div class="owerlay">\n                            <p class="owerlay-content">quick view</p>\n                        </div>\n                    </div>\n                    <p class="title-book">${(0,a.shortTitle)(o,17)}</p>\n                    <p class="title-author">${(0,a.shortTitle)(s,34)}</p>\n                </li>`)).join("")}</ul>\n                            <button type="button" class="button-more js-btn-more" id="${e}">See more</button>\n                        </li>`}return`<li class="off-books best-book-container">${s}\n                            <p class="off-books-text">Sorry, there are no books in this category, please choose another category</p>\n                        </li>`})).join("")}function h(e,t){if(e.length){return e.map((({_id:e,book_image:t,author:o,title:s})=>`<li class="item-book" data-id="${e}">  \n                <div class="img-owerlay">\n                    <img src="${t}" alt="${s}" class="img-book loading="auto"">\n                    <div class="owerlay">\n                        <p class="owerlay-content">quick view</p>\n                    </div>\n                </div>\n                <p class="title-book">${(0,a.shortTitle)(s,17)}</p>\n                <p class="title-author">${(0,a.shortTitle)(o,34)}</p>\n            </li>`)).join("")}return'<liv class="off-books">\n                            <p class="off-books-text">Sorry, there are no books in this category, please choose another category</p>\n                        </li>'}d.addEventListener("click",(()=>{(0,a.scrollUp)(),d.classList.add("is-hidden-btn")})),window.addEventListener("scroll",(()=>{(0,a.scrollTracker)(d)})),async function(){(0,a.scrollUp)(),u=document.createElement("h3"),u.textContent="All categories",u.classList.add("category-list-item","active"),u.setAttribute("id","all-categories-item"),i.prepend(u),u.click();const e=(0,a.createLoader)(u),t=await async function(){try{const{data:e}=await l.getCategoryList();return e.length?e:Notify.failure("Can't find list of categories on the server. Please reload the page!")}catch(e){if("ERR_CANCELED"!==e.code){console.error(e);const t=document.createElement("div");u.after(t),t.classList.add("error-box"),t.innerHTML='<p class="error-box-text">Sorry, there was a server error, please reload the page!!!</p>'}return[]}}();t.length&&(m=document.createElement("ul"),u.after(m),m.classList.add("category-list"),m.innerHTML=function(e){let t="";return e.forEach((e=>{const o=`  <li id="${e.list_name}" class="category-list-item"> \n                                       ${e.list_name}\n                                    </li> `;t+=o})),t}(t),i.classList.add("category-list-box-not-empty"));e.remove()}(),r("8e037");var f;n=r("aiKfP"),a=r("hqv3x");f=new URL(r("kyEFX").resolve("cKEZp"),import.meta.url).toString();var v;v=new URL(r("kyEFX").resolve("gcCvB"),import.meta.url).toString();const L=new(0,n.booksAPI);let E,S;const w=document.querySelector(".books-box"),x=document.querySelector(".book-modal-backdrop"),_=document.querySelector(".btn-modal-close"),T=document.querySelector(".add"),B=document.querySelector(".remove"),q=document.querySelector(".modal-message"),$={scrollPosition:0,disabledScroll(){$.scrollPosition=window.scrollY,document.body.classList.add("block-scroll"),console.log($.scrollPosition),document.body.style.cssText=`top: -${$.scrollPosition}px;`},enabledScroll(){document.body.classList.remove("block-scroll"),document.body.style.cssText="top: 0",window.scroll({top:$.scrollPosition})}};async function C(t){S&&(S.abort(),console.log("abort previous book fetch")),$.disabledScroll(),document.addEventListener("keydown",(e=>{"Escape"===e.key&&I()}),{once:!0});try{S=new AbortController;const o=await L.getBookById(t,S),{author:s,book_image:r,description:n,title:a,buy_links:l}=o.data,i=document.querySelector(".book-img-div"),c=document.querySelector("#name-book"),d=document.querySelector("#author"),m=document.querySelector("#description"),u=document.querySelector(".market_placers_list");c.textContent=a,d.textContent=s,m.textContent=""===n?"No description":n,i.innerHTML=`<img src="${r}" alt="${r}" class="book-img-modal" loading="auto">`,u.innerHTML=`<li class="marketplacer_li marketplacer_li_one">\n                                    <a href="${l[0].url}" class="marketplacer_li_link link">\n                                    <img class="image-market" src="${e(f)}" alt="amazon">  \n                                    </a>\n                                </li>\n\n                                <li class="marketplacer_li marketplacer_li_two">\n                                    <a href="${l[1].url}" class="marketplacer_li_link link">\n                                    <img class="image-market" src="${e(v)}" alt="apple-books">      \n                                    </a>\n                                </li>`,x.classList.toggle("is-hidden");const p=JSON.parse(localStorage.getItem("orderedBookID"));null!==p&&p.includes(t)?(B.classList.remove("is-hidden"),q.classList.remove("is-hidden")):T.classList.remove("is-hidden")}catch(e){if("ERR_CANCELED"!==e.code){console.error("тут"),console.error(e);const t=document.querySelector(".book-modal-container").createElement("div");_.after(t),t.classList.add("error-box"),t.innerHTML='<p class="error-box-text">Sorry, there was a server error, please reload the page!!!</p>'}}}function I(){$.enabledScroll(),x.classList.add("is-hidden"),B.classList.add("is-hidden"),T.classList.add("is-hidden"),q.classList.add("is-hidden")}w.addEventListener("click",(function({target:e}){console.dir(e),e.classList.contains("img-book")||e.classList.contains("owerlay")?(E=e.parentElement.parentElement.dataset.id,C(E)):e.classList.contains("owerlay-content")?(E=e.parentElement.parentElement.parentElement.dataset.id,C(E)):(e.classList.contains("title-book")||e.classList.contains("author"))&&(E=e.parentElement.dataset.id,C(E))})),_.addEventListener("click",I),T.addEventListener("click",(function(){T.classList.add("is-hidden"),B.classList.remove("is-hidden"),q.classList.remove("is-hidden");const e=localStorage.getItem("orderedBookID");let t=JSON.parse(e);null===t&&(t=[]);t.push(E),localStorage.setItem("orderedBookID",JSON.stringify(t)),(0,a.displayOrdredAmountInShoppingBag)(t)})),B.addEventListener("click",(function(){T.classList.remove("is-hidden"),B.classList.add("is-hidden"),q.classList.add("is-hidden");const e=localStorage.getItem("orderedBookID"),t=JSON.parse(e);let o=t.indexOf(E);t.splice(o,1),localStorage.removeItem("orderedBookID"),localStorage.setItem("orderedBookID",JSON.stringify(t)),(0,a.displayOrdredAmountInShoppingBag)(t)})),r("iNkvP"),r("kU5er");const H=document.querySelector(".js-nav-homelink"),N=document.querySelector(".js-mobile-nav-homelink");H.classList.toggle("selected"),N.classList.toggle("mobile-selected");
//# sourceMappingURL=index.b4f11b24.js.map
